"use strict";(()=>{var e={};e.id=4545,e.ids=[4545],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},38358:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>y,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>h,staticGenerationAsyncStorage:()=>m});var i={};r.r(i),r.d(i,{GET:()=>c,dynamic:()=>d});var a=r(49303),s=r(88716),o=r(60670),n=r(87070),u=r(20728);let d="force-dynamic";async function c(e){try{let{searchParams:t}=new URL(e.url),r="true"===t.get("includeSchedules"),i=await u._.route.findMany({where:{isActive:!0},include:r?{schedules:{where:{isActive:!0},include:{departures:{where:{date:{gte:new Date},status:{in:["SCHEDULED","BOARDING"]}},orderBy:{date:"asc"},take:30}},orderBy:{time:"asc"}}}:void 0,orderBy:{name:"asc"}}),a=i.map(e=>{let t={id:e.id,name:e.name,origin:e.origin,destination:e.destination,duration:e.duration,isActive:e.isActive};return r&&e.schedules?{...t,schedules:e.schedules.map(t=>({id:t.id,time:t.time,dayOfWeek:t.dayOfWeek,capacity:t.capacity,isActive:t.isActive,route:{id:e.id,name:e.name,origin:e.origin,destination:e.destination,duration:e.duration},upcomingDepartures:t.departures.map(e=>({id:e.id,date:e.date,capacity:e.capacity,bookedSeats:e.bookedSeats,availableSeats:e.capacity-e.bookedSeats,status:e.status}))}))}:t});return n.NextResponse.json({routes:a,count:i.length})}catch(e){return console.error("Routes fetch error:",e),n.NextResponse.json({error:"Failed to fetch routes",routes:[]},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/routes/route",pathname:"/api/routes",filename:"route",bundlePath:"app/api/routes/route"},resolvedPagePath:"C:\\Users\\priej\\skoot-transportation\\src\\app\\api\\routes\\route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:h}=p,v="/api/routes/route";function y(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:m})}},20728:(e,t,r)=>{r.d(t,{_:()=>a});let i=require("@prisma/client"),a=globalThis.prisma??new i.PrismaClient}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[8948,5972],()=>r(38358));module.exports=i})();